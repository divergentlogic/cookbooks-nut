# Generated by Chef for <%= node[:fqdn] %>
#
# Network UPS Tools: upsmon configuration
# --------------------------------------------------------------------------
<% unless node['nut']['run_as_user'].nil? %>
RUN_AS_USER <%= node['nut']['run_as_user'] %>
<% end %>

<% node['nut']['monitors'].each do |name, values| %>
MONITOR <%= "#{values['system']} #{values['power_value']} #{values['username']} #{values['password']} #{values['role']}" %> 
<% end %>

MINSUPPLIES <%= node['nut']['min_supplies'] %>

SHUTDOWNCMD "<%= node['nut']['shutdown_command'] %>"

<% unless node['nut']['notify_command'].nil? %>
NOTIFYCMD <%= node['nut']['notify_command'] %>
<% end %>

POLLFREQ <%= node['nut']['poll_frequency'] %>

POLLFREQALERT <%= node['nut']['poll_frequency_alert'] %>

HOSTSYNC <%= node['nut']['host_sync'] %>

DEADTIME <%= node['nut']['deadtime'] %>

POWERDOWNFLAG <%= node['nut']['power_down_flag'] %>

<% unless node['nut']['notifications']['onilne']['message'].nil? %>
NOTIFYMSG ONLINE <%= node['nut']['notification']['onilne']['message'] %>
<% end %>
<% unless node['nut']['notifications']['on_battery']['message'].nil? %>
NOTIFYMSG ONBATT <%= node['nut']['notifications']['on_battery']['message'] %>
<% end %>
<% unless node['nut']['notifications']['low_battery']['message'].nil? %>
NOTIFYMSG LOWBATT <%= node['nut']['notifications']['low_battery']['message'] %>
<% end %>
<% unless node['nut']['notifications']['forced_shutdown']['message'].nil? %>
NOTIFYMSG FSD <%= node['nut']['notifications']['forced_shutdown']['message'] %>
<% end %>
<% unless node['nut']['notifications']['communication_ok']['message'].nil? %>
NOTIFYMSG COMMOK <%= node['nut']['notifications']['communication_ok']['message'] %>
<% end %>
<% unless node['nut']['notifications']['communication_bad']['message'].nil? %>
NOTIFYMSG COMMBAD <%= node['nut']['notifications']['communication_bad']['message'] %>
<% end %>
<% unless node['nut']['notifications']['shutdown']['message'].nil? %>
NOTIFYMSG SHUTDOWN <%= node['nut']['notifications']['shutdown']['message'] %>
<% end %>
<% unless node['nut']['notifications']['replace_battery']['message'].nil? %>
NOTIFYMSG REPLBATT <%= node['nut']['notifications']['replace_battery']['message'] %>
<% end %>
<% unless node['nut']['notifications']['no_communication']['message'].nil? %>
NOTIFYMSG NOCOMM <%= node['nut']['notifications']['no_communication']['message'] %>
<% end %>
<% unless node['nut']['notifications']['no_parent']['message'].nil? %>
NOTIFYMSG NOPARENT <%= node['nut']['notifications']['no_parent']['message'] %>
<% end %>

<% unless node['nut']['notifications']['onilne']['flags'].nil? %>
NOTIFYFLAG ONLINE <%= node['nut']['notification']['onilne']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['on_battery']['flags'].nil? %>
NOTIFYFLAG ONBATT <%= node['nut']['notifications']['on_battery']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['low_battery']['flags'].nil? %>
NOTIFYFLAG LOWBATT <%= node['nut']['notifications']['low_battery']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['forced_shutdown']['message'].nil? %>
NOTIFYFLAG FSD <%= node['nut']['notifications']['forced_shutdown']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['communication_ok']['flags'].nil? %>
NOTIFYFLAG COMMOK <%= node['nut']['notifications']['communication_ok']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['communication_bad']['flags'].nil? %>
NOTIFYFLAG COMMBAD <%= node['nut']['notifications']['communication_bad']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['shutdown']['flags'].nil? %>
NOTIFYFLAG SHUTDOWN <%= node['nut']['notifications']['shutdown']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['replace_battery']['flags'].nil? %>
NOTIFYFLAG REPLBATT <%= node['nut']['notifications']['replace_battery']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['no_communication']['flags'].nil? %>
NOTIFYFLAG NOCOMM <%= node['nut']['notifications']['no_communication']['flags'] %>
<% end %>
<% unless node['nut']['notifications']['no_parent']['flags'].nil? %>
NOTIFYFLAG NOPARENT <%= node['nut']['notifications']['no_parent']['flags'] %>
<% end %>

RBWARNTIME <%= node['nut']['replace_battery_warning_time'] %>

NOCOMMWARNTIME <%= node['nut']['no_communications_warning_time'] %>

FINALDELAY <%= node['nut']['final_delay'] %>

